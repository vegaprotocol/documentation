---
sidebar_position: 2
title: Configure and run
hide_title: false
---
## Configuring the components and getting it up and running
Once you have all the executables you need, you must configure them to run correctly and to connect to the existing network.

First, generate the default configuration files for Vega and Tendermint. You can then alter those to the specific requirements.

The below command creates files in your `~/.config/vega/node folder`

```
vega init validator
```

The following command creates tendermint configuration files in your `~/.tendermint folder`

```
vega tm init validator
```

## Set up the node wallet
Each validator node requires two cryptographic wallets to operate properly:
* Ethereum wallet: Used to sign transactions going through the ERC20 bridge
* Vega wallet: Used to sign transaction sent by validators in the Vega network

The public key of the Tendermint node also needs to be saved in the node wallet. 

All this information needs to be checked in properly before starting the node. When the network starts or a node is added to the validator set, this information will be checked against the transaction used to register the node on the network. Any incorrect set-up will stop the node from joining the network.

You need to generate or import the wallet information for tendermint, vega and Ethereum. See below for [Ethereum wallet instructions](#ethereum-wallet).

:::note
You will be asked for a passphrase for your node wallet, which you created when you initialised Vega. Make sure to save this passphrase in a text file, somewhere secure, as it allows you to unlock the node wallet. 

The following command should output the path of the main configuration file. Feel free to open and change settings if needed.
:::

```
echo “yourpassword” > ~/password.txt
vega nodewallet generate --chain=vega --wallet-passphrase-file="password.txt"
```

### Tendermint public key
To save the Tendermint public key in your node wallet, look in your tendermint config `~/.tendermint/config/priv_validator_key.json` for your tendermint public key, and import it.

```
vega nodewallet import --chain=tendermint --tendermint-pubkey="YOUR_TENDERMINT_PUBKEY"
```

If your Tendermint node is set up to use `tmkms`, then refer to the [documentation ↗](https://github.com/iqlusioninc/tmkms) to get your public key.

:::note
If you are not using tmkms (e.g: the default software keys generated by tendermint, run the following command instead:
```
vega nodewallet import --chain=tendermint --home=path/to/home --tendermint-home=path/to/tendermint
```
This will read the Tendermint keys from the configuration path, and set up your node wallet properly.
:::

### Ethereum wallet
Vega supports two types of Ethereum wallet: you can either register a wallet available from a clef instance or import a keystore file (e.g: create with `geth account`).

#### Using clef
To set up your clef instance please refer to the [clef documentation ↗](https://geth.ethereum.org/docs/clef/tutorial).

Set the address of your clef instance in the Vega configuration (`path/to/home/config/node/config.toml`):
```Toml
[NodeWallet]
  Level = "Info"
  [NodeWallet.ETH]
    Level = "Info"
    Address = ""
    ClefAddress = "http://your.clef.instance.network:3334"
```

Alternatively you can run the following command and specify the flag: 
```
--eth.clef-address="http://your.clef.instance.network:3334"
```

Then run the following command:
```
vega nodewallet import --chain=ethereum --home=path/to/home --clef-account-address="0xYOUR_WALLET_ADDRESS"
```

#### Using a keystore account file
You can either import an existing keystore or create a new one. (Learn how to create a keystore [using geth ↗](https://geth.ethereum.org/docs/getting-started)) 

Import an existing keystore using the following command:
```
vega nodewallet import --chain=ethereum --home="path/to/home" --wallet-passphrase-file="file/containing/account/passphrase" --wallet-path="path/to/wallet"
```

Or use the following command to create a new keystore and save it in the node wallet:
```
vega nodewallet generate --chain=ethereum --home="path/to/home" --wallet-passphrase-file="file/containing/account/passphrase"
```

### Ethereum node
Next you need either a local Ethereum node or an infura account. 

Setting up an infura account can be achieved with the following steps:

1. Login to infura and go to the dashboard (create an account first if you need one)
2. Select the orange “CREATE NEW KEY” button from the top right of the page
3. Select the network as `Web3 API`

Enter anything as the Name and press “CREATE”.

Under the Ethereum section there is a drop down from which you can select “Ropsten” for testnet or "Mainnet". 

The URL shown is the address you need for the next change.

Insert the URL into the [Ethereum] -> RPCEndpoint key in `~/.config/vega/node/config.toml`

## This needs to be replaced by Jeremy [WIP]
You now need to get the copy of the network genesis file from one of the existing validator nodes. This is a manual process and requires talking to an existing validator. Once you have that, copy it over your version in `~/.tendermint/config/genesis.json`

Next you need the tendermint ID and connection details for one or more validators on the network you are trying to join. This step has to be done manually and relies on existing validators publishing these details. Once you have them, enter them into the `persistent_peers` section in the file `~/.tendermint/config/config.toml`.

You can now start the your node by running the following command:
`vega node`

### Stake to your validating node
Once your Vega node is visible, you will need to provide your self-stake. Self-stake requires a minimum amount of Vega, an amount defined by a network parameter: <NetworkParameter frontMatter={frontMatter} param="reward.staking.delegation.minimumValidatorStake" hideName={false} suffix="tokens" /> 

The tokens that you want to use for self-staking must available on an Ethereum wallet, and then associated to a Vega key.

Associate your tokens and nominate your node using the [token dApp ↗](https://token.fairground.wtf/staking).